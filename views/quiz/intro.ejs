<!DOCTYPE HTML>

<html>

<head>
   <script type="text/javascript" src="/js/jquery.js"></script>
   <script src="/js/bootstrap.min.js"></script>
   <script type="text/javascript" src="/js/socket.io.js"></script>
   <script type="text/javascript" src="/js/sails.io.js"></script>
   <script type="text/javascript" src="/js/app.js"></script>

   <script src="/js/jquery-ui-1.10.3.custom.min.js"></script>
   <script src="/js/jquery.ui.touch-punch.min.js"></script>
   <script src="/js/bootstrap-select.js"></script>
   <script src="/js/bootstrap-switch.js"></script>
   <script src="/js/flatui-checkbox.js"></script>
   <script src="/js/flatui-radio.js"></script>
   <script src="/js/jquery.tagsinput.js"></script>
   <script src="/js/jquery.placeholder.js"></script>
   <script src="/js/jquery.stacktable.js"></script>

    <link href="/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="/css/flat-ui.css" rel="stylesheet">

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title><%= title %></title>

    <style type="text/css">
        body {
            position: relative;
            font: 71%/1.5 Verdana, Sans-Serif;
            background: rgba(255, 255, 255, 1);
        }

        .space {
            margin-top: 40px;
        }

        .colorRed {
            color: #f57f25;
        }

        #container {
            margin: 50px auto;
            width: 1376px;
        }

        #keyboard {
            margin: 0;
            padding: 0;
            list-style: none;
        }

        #keyboard li {
            border: 2px solid #bdc3c7;
            color: #34495e;
            background: #fff;
            font-family: "Lato", sans-serif;

            float: left;
            margin: 0 5px 5px 0;
            width: 80px;
            height: 80px;
            line-height: 80px;
            text-align: center;
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;

            font-size: 220%;

            -moz-user-select: none;
            -khtml-user-select: none;
            -webkit-user-select: none;
            -o-user-select: none;
        }

        .capslock, .tab, .left-shift {
            clear: left;
        }

        #keyboard .tab, #keyboard .delete {
            width: 140px;
        }

        #keyboard .capslock {
            width: 160px;
        }

        #keyboard .return {
            width: 150px;
        }

        #keyboard .left-shift {
            width: 190px;
        }

        #keyboard .rightright-shift {
            width: 218px;
        }

        #keyboard .return {
            border: 2px solid #666;
            background: #f57f25;
            color: white;
        }

        #keyboard .right-at {
            width: 118px;
        }

        .lastitem {
            margin-right: 0;
        }

        .uppercase {
            text-transform: uppercase;
        }

        #keyboard .space {
            clear: left;
            width: 1295px;
        }

        .on {
            display: none;
        }

        #keyboard li:hover {
            position: relative;
            top: 1px;
            left: 1px;
            border-color: #f57f25;
            cursor: pointer;
        }

        .photo-right-corner {
            height: 500px;
            position:absolute;
            bottom: 0;
            right:50px;
        }

        .photo-bubble {
            height:80px;
            position:absolute;
            bottom: 500px;
            right:55px;
        }

        .photo-left {
            height: 250px;
            position:absolute;
            bottom: 0;
            left:20px;

        }

        .photo-right {
            height: 250px;
            position:absolute;
            bottom: 0;
            right:30px;
        }

        .modal {
            width: 1000px;
            margin-left: -500px;
        }

        .photo {
            width:200px;

            -moz-border-radius: 10px;
            -webkit-border-radius: 10px;
        }

        .modal-body {
            padding: 30px;
            width: 1000px;
            height:600px;
            text-align:center;

            vertical-align: middle;
            display: table-cell;
            position:relative;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span4 offset4">
                <img class="space" width="500px" src="/images/titolo2.jpg"> </img>
            </div>
        </div>

        <div class="row-fluid">
            <div class="span12" style="text-align:center">
                <h2 class="colorRed"><%= res.i18n({phrase: 'welcome_description', locale: lang}) %></h2>
            </div>
        </div>

        <div class="row-fluid">
            <div class="span12" style="text-align:center">
                <h4 class-="colorRed"><%= res.i18n({phrase: 'welcome_email', locale: lang}) %> <br/></h4>
            </div>
        </div>

        <div class="row-fluid">
            <div class="span4 offset4">
                <input class="span12" style="text-align:center; font-size:200%" id="email" type="text" value=""/>
            </div>
        </div>

         <div class="row-fluid">
            <div class="span2 offset4">
                <a class="btn btn-large btn-block btn-primary" id="submit"><%= res.i18n({phrase: 'button_submit', locale: lang}) %></a>
            </div>

            <div class="span2">
                <a class="btn btn-large btn-block btn-primary" id="resetEmail"><%= res.i18n({phrase: 'button_resetEmail', locale: lang}) %></a>
            </div>
        </div>

        <div class="row-fluid">
            <div class="span12" style="text-align:center;">
                <h4 class="colorRed" id="errorEmail" style="height:30px;"></h4>
            </div>
        </div>

        <div id="container" style="margin-top:0px;">
            <ul id="keyboard">
                <li class="symbol"><span class="off">`</span><span class="on">~</span></li>
                <li class="symbol"><span class="off">1</span><span class="on">!</span></li>
                <li class="symbol"><span class="off">2</span><span class="on">@</span></li>
                <li class="symbol"><span class="off">3</span><span class="on">#</span></li>
                <li class="symbol"><span class="off">4</span><span class="on">$</span></li>
                <li class="symbol"><span class="off">5</span><span class="on">%</span></li>
                <li class="symbol"><span class="off">6</span><span class="on">^</span></li>
                <li class="symbol"><span class="off">7</span><span class="on">&amp;</span></li>
                <li class="symbol"><span class="off">8</span><span class="on">*</span></li>
                <li class="symbol"><span class="off">9</span><span class="on">(</span></li>
                <li class="symbol"><span class="off">0</span><span class="on">)</span></li>
                <li class="symbol"><span class="off">-</span><span class="on">_</span></li>
                <li class="symbol"><span class="off">=</span><span class="on">+</span></li>
                <li class="delete lastitem">delete</li>
                <li class="tab">tab</li>
                <li class="letter">q</li>
                <li class="letter">w</li>
                <li class="letter">e</li>
                <li class="letter">r</li>
                <li class="letter">t</li>
                <li class="letter">y</li>
                <li class="letter">u</li>
                <li class="letter">i</li>
                <li class="letter">o</li>
                <li class="letter">p</li>
                <li class="symbol"><span class="off">[</span><span class="on">{</span></li>
                <li class="symbol"><span class="off">]</span><span class="on">}</span></li>
                <li class="symbol lastitem"><span class="off">\</span><span class="on">|</span></li>
                <li class="capslock">caps lock</li>
                <li class="letter">a</li>
                <li class="letter">s</li>
                <li class="letter">d</li>
                <li class="letter">f</li>
                <li class="letter">g</li>
                <li class="letter">h</li>
                <li class="letter">j</li>
                <li class="letter">k</li>
                <li class="letter">l</li>
                <li class="symbol"><span class="off">;</span><span class="on">:</span></li>
                <li class="symbol"><span class="off">'</span><span class="on">&quot;</span></li>
                <li class="return lastitem">enter</li>
                <li class="left-shift">shift</li>
                <li class="letter">z</li>
                <li class="letter">x</li>
                <li class="letter">c</li>
                <li class="letter">v</li>
                <li class="letter">b</li>
                <li class="letter">n</li>
                <li class="letter">m</li>
                <li class="symbol"><span class="off">,</span><span class="on">&lt;</span></li>
                <li class="symbol"><span class="off">.</span><span class="on">&gt;</span></li>
                <li class="symbol"><span class="off">/</span><span class="on">?</span></li>
                <li class="right-shift lastitem">shift</li>
                <li class="right-at">@</li>
                <li class="space lastitem">&nbsp;</li>
            </ul>
        </div>
    </div>

    <div id="creditModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h1 class="colorRed"><%=  res.i18n({phrase: 'welcome_developers', locale: lang}) %></h1>
            </div>
        <div class="modal-body">
            <div class="row-fluid">
                <div class="span6">
                    <img class="photo" src="/images/solita.png"> </img>
                </div>

                <div class="span6">
                    <img class="photo" src="/images/348fa5b.jpg"> </img>
                </div>
            </div>
            <p style="height:70px;">&nbsp</p>
            <div class="row-fluid">
                <div class="span12">
                    <p style="text-align: justify;">
                        <h5>Andrea Gallidabino e Marcello Romanilli, entrambi di 25 anni, originari di Lugano sono studenti del secondo anno di Master della Facoltà di scienze informatiche dell’ Università della Svizzera italiana.</h5>
                    </p>
                </div>
            </div>
            <p style="height:250px;">&nbsp</p>

            <img class="photo-left" src="/images/Avatars/a3.png"> </img>
            <img class="photo-right" src="/images/Avatars/m4.png"> </img>
        </div>
        <div class="modal-footer">
            <a href="#" class="btn btn-primary" data-dismiss="modal" aria-hidden="true">Chiudi</a>
        </div>
    </div>

    <img class="photo-right-corner" src="/images/me_normal.png"> </img>
    <img class="photo-bubble" src="/images/test.png"> </img>

    <script>
        var lang = "<%= lang%>"
        $(document).ready(function() {
            $('#submit').click(function () {
                if($('#email').val() == mail || $('#email').val().indexOf('/') != -1 || $('#email').val().indexOf('<') != -1 || $('#email').val().indexOf('>') != -1) {
                    $('#errorEmail').html(invalidEmail)
                } else {
                    socket.request('/email', {email: $('#email').val()}, function(res) {
                        if(res.success) {
                            window.location = "/quiz/" + lang + "/" + $('#email').val()
                        } else {
                            $('#errorEmail').html(invalidEmail)
                        }
                    })
                }
            })
        })
    </script>

    <script>
        var invalidEmail = "<%= res.i18n({phrase: 'welcome_invalidEmail', locale: lang}) %>"
        var prefix = ""
        var mail = ""

        $(function(){
            $('.photo-right-corner').click(function() {
                $('#creditModal').modal()
            })

            $('.photo-bubble').click(function() {
                $('#creditModal').modal()
            })

            $('#resetEmail').click(function () {
                prefix = ""
                $write.val(prefix + mail)
            })

            $(this).bind("contextmenu", function(e) {
                e.preventDefault();
            });

            var $write = $('#email'),
                shift = false,
                capslock = false;

            $('#keyboard li').click(function(){
                var $this = $(this),
                    character = $this.html(); // If it's a lowercase letter, nothing happens to this variable

                // Shift keys
                if ($this.hasClass('left-shift') || $this.hasClass('right-shift')) {
                    $('.letter').toggleClass('uppercase');
                    $('.symbol span').toggle();

                    shift = (shift === true) ? false : true;
                    capslock = false;
                    return false;
                }

                // Caps lock
                if ($this.hasClass('capslock')) {
                    $('.letter').toggleClass('uppercase');
                    capslock = true;
                    return false;
                }

                // Delete
                if ($this.hasClass('delete')) {
                    prefix = prefix.substr(0, prefix.length - 1)
                    $write.val(prefix +  mail);
                    return false;
                }

                // Special characters
                if ($this.hasClass('symbol')) character = $('span:visible', $this).html();
                if ($this.hasClass('space')) character = ' ';
                if ($this.hasClass('tab')) character = "\t";
                if ($this.hasClass('return')) {
                    $('#submit').click()
                    character = ''
                }

                // Uppercase letter
                if ($this.hasClass('uppercase')) character = character.toUpperCase();

                // Remove shift once a key is clicked.
                if (shift === true) {
                    $('.symbol span').toggle();
                    if (capslock === false) $('.letter').toggleClass('uppercase');

                    shift = false;
                }

                // Add the character
                prefix = prefix + character
                $write.val(prefix + mail);
            });
        });
    </script>
</body>
</html>